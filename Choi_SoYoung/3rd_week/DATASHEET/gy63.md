# gy63 고도센서<p>

### 일반
---
- 이 제품은 피에조 저항과 인터페이스 IC로 구성됨
- 비보상 아날로그 출력 전압을 피에조 저항 압력센서에서 24비트로 전환하고 온도에 대한 24비트 디지털 값을 제공

### SERIAL Interface
---
- SPI와 I2C의 두 직렬 인터페이스로 구축
- SPI 프로토콜을 선택한 후 PS를 HIGH로 끌어 I2C버스 프로토콜을 활성화

### SPI모드
---
- 외부 마이크로컨트롤러는 SCLK 및 SDI 입력을 통해 데이터 클록을 조정
- 안에 SPI모드 모듈은 클럭의 극성과 위상에 대하 모드 0과 모드 3을 모두 허용
- 센서는 출력 SDO(Serial Data Out)핀에 반응 
- CSB(Cip Select)핀은 인터페이스를 활성화/비활성화 하는데 쓰임
	- 그래서 다른 장치들이 같은 SPI 버스에서 통신할 수 있음
	- 명령이 전송된 후 또는 명령 실행 종료 후에(ex: 변환종료) high로 끌어올수있다.
- ADC 변환 중에 다른 장치와 통신하지 않고 게으를 때가 모듈에서 발생하는 최상의 소음 성능
#### command
- ADC가 읽기 명령을 읽은 뒤 장치는 24bit를 반환
- PROM이 읽기 명령후 16bit를 반환
- PROM의 주소는 a2,a1,a0 bit를 이용한 PROM 읽기 명령 안에 들어있음

#### reset sequence
- 교정 PROM이 내부 레지스터에 로드되도록 전원을 켠 후 재 설정 시퀸스를 한번 전송해야함
- 모르는 상태로 부터 ROM을 리셋시키는 데에도 사용됨

#### conversion sequence
- 보정되지 않은 기압이나 보정되지 않은 온도변환을 개시하는데 사용
- 다른 장치들과 소통하는 동안 칩을 비활성화 시킬 수 있음
- 변환 후 ADC 읽기 명령을 사용해서 MSB에서 먼저 결과를 기록
- 만약 ADC 읽기 명령전에 변환이 되지 않거나 ADC 읽기 명령이 반복되었을때 출력결과는0
- 만약 변환중에 ADC 읽기 명령을 보내면 출력결과는 0
 - 변환은 중지되지 않고 결과가 틀림
- 이미 시작된 변환 프로세스중에 전송된 변환 순서에도 잘못된 결과 발생

#### prom read sequence
- PROM에서 오는 읽기명령은 사용자가 교정PROM의 내용을 읽고 교정계수를 계산하기위해 리셋한 후 한번 실행되어야 함
- 총 8개의 주소가 128bit의 총 메모리에 있음
- 주소0은 공장 데이터와 설정, 주소 1~6의 교정계수를 포함
- 주소7은 serial코드와 CRC를 포함
- 8bit이며 16bit 결과가 MSB로 먼저 기록됨

### I2C모드
---
- 외부 마이크로 컨트롤러는 SDA와 SCLK 입력을 통해 데이터에 클록을 적용
- I2C 버스 인터페이스의 양방향인 동일한 핀 SDA에 응답
 - 2개의 신호라인만 존재하고 칩 선택이 필요하지 않으므로 보드공간 줄임
- 핀 CSB의 보어는 I2C주소의 LSB를 나타냄
- 두개의 센서에 두개의 다른 주소가 존재
- 핀 VDD 또는 GND에 연결해야함

#### command
- 각각의 I2C 명령 메시지는 시작상태와 함께 시작하고 정지상태와 함께 끝남
- 이 장치의 주소에서 C는 핀 CSB의 보완 값
- IC가 내부에 마이크로컨트롤러를 가지지 않은 때부터 I2C와 SPI의 명령이 조금 더 비슷해짐

#### reset sequence
- 리셋은 언제든지 발송 가능
- 리셋을 하지 못하였을 경우는 승인 모듈에 의해 SDA가 차단되여 발생할 수 있음
 - 이럴 경우 SCLK를 여러개 보낸 뒤 reset sequence를 보내거나 전원을 다시 켜야 함
- MASTER: 시작신호, 장치주소, 쓰기, 리셋명령, 정지신호
- SLAVE: 신호,명령을 잘 받았는지 응답

#### prom read sequence(2개로 구성)
 - PROM read 모드로 시스템을 변환
  - MASTER: 시작신호, 장치주소, 쓰기, 변환명령, 정지신호
  - SLAVE: 신호,명령을 잘 받았는지 응답
 - 시스템에서 데이터를 가지고 옴
  - MASTER: 시작신호, 장치주소, 읽기, SLAVE에서 보낸 데이터를 잘 받았는지 못받았는지 응답,정지신호
  - SLAVE: 읽기신호,명령을 잘 받았는지 응답, 메모리bit데이터 보내기
 
#### conversion sequence
- 장치로 명령을 보내는 것으로 시작
- 시스템에 명령을 전송하면 변환이 완료될 때까지 명령을 계속 사용가능
- 변환이 완료되면 데이터는 읽기명령에 접근할 수 있음
- 장치로부터 응답이 올 때까지 24 SCLK 사이클은 모든 결과 bit로 보내질 수 있음
- 모든 8bit는 응답 신호가 올 때까지 그 시스템은 대기함
- I2C Command to initiate a pressure conversion
 - MASTER: 시작신호, 장치주소, 쓰기, 명령, 정지신호
 - SLAVE: 신호,명령을 잘 받았는지 응답
- I2C ADC read sequence
 - MASTER: 시작신호, 장치주소, 쓰기, 명령, 정지신호
 - SLAVE: 신호,명령을 잘 받았는지 응답
- I2C answer from MS5611-01BA
 - MASTER: 시작신호, 장치주소, 읽기, SLAVE에서 보낸 데이터를 잘 받았는지 못받았는지 응답, 정지신호
 - SLAVE: 읽기신호,명령을 잘 받았는지 응답, 메모리bit데이터 보내기 
   