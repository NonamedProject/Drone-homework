# 12C

### 통신개요

* 직렬 컴퓨터 버스이며.  마더보드, 임베디드 시스템, 휴대전화등에 저속의 주변기기를 연결하기 위해 사용된다.
* 데이터라인(SDA)과 클럭라인(SCL) 2라인의 연결만 이루어 진다면 통신이 가능하다.
* I2C의 통신은 Master-Slave관계로 통신을 하게 되며 Master는 하나만 존재하며 Slave에게 데이터 요청을 할 수 있고, Slave는 각 기기마다 구별하기 위한 번호를 가지며 Master가 데이터를 요청하면 데이터를 전송할 수 있다.
* 복수 개의 슬레이브 장치가 복수개의 마스터 장치와 통신하기 위한 프로토콜
* 동기식(synchronous) 시리얼 통신 방법
* UART 통신처럼 단 두 라인만 사용하고 1008 개의 슬레이브 장치를 지원합니다. 또한 N:N 통신도 지원이 가능합니다. (단 마스터 장치끼리 통신은 불가)



### 하드웨어

* I2C 통신은 두 개의 라인 – SCL, SDA 를 사용
* SCL: 클럭 신호를 생성해서 전달하는 역할
* SDA: 실제 데이터가 전달되는 라인
*  SDA, SCL 은 모두 풀업 저항에 연결되어 있으므로 통신라인이 사용이 끝나면 자동으로 HIGH 상태로 복귀
* open drain: I2C 통신을 사용하는 장치 하나가 데이터 전송을 위해 라인에 LOW 신호를 넣고 있으면 다른 장치들은 이걸 강제로 HIGH로 바꿀 수 없다.



### 프로토콜

##### 기본 구조

* I2C가 전송하는 메시지는 2개의 프레임 – 주소(address) 프레임과 데이터(data) 프레임으로 구분
* 주소 프레임: 마스터가 전송하는 데이터가 어떤 슬레이브로 가는지 알려주기 위한 프레임
* 데이터 프레임: 실제 전송하려는 데이터가 담긴 프레임

##### 통신 시작 조건

* 데이터 통신을 시작하기 위해서는 주소 프레임부터 전송해야 합니다. 이를 위해 마스터 장치는 SCL(클럭) 라인을 HIGH 상태로 두고, SDA(데이터) 라인을 LOW로 변경합니다. 이 신호는 모든 슬레이브 장치들에게 데이터를 전송할 준비가 되었다는 신호로 인식됩니다. 만약 회로에 마스터 장치가 여러개 붙어 있다면 먼저 SDA 라인을 LOW 로 잡는 이가 제어권을 갖습니다.

##### 통신 종료 조건

* 모든 데이터 프레임이 전송되면 마스터 장치는 종료 신호를 만들어야 합니다. 종료 신호는 클럭 라인인 SCL 을 0->1(LOW to HIGH) 상태로 변경한 뒤, SCL 라인이 HIGH 인 상태에서 SDA 라인을 0->1 (LOW to HIGH)로 변경하면 됩니다. 따라서 반드시 모든 장치들은 반드시 SCL 라인이 HIGH 인 상태에서 SDA 라인의 상태를 변경해서는 안됩니다. 이런 동작은 잘못된 종료신호로 인식될 수 있기 때문입니다.