  

## 직렬 통신과 병렬 통신

 마이크로프로세서는 주변 장치를 통해서 외부와 정보를 교환 할 수 있다. 일반적으로 정보를 교환하는 방법으로는 직렬통신과 병렬통신 2가지로 나눌 수 있다.

### 병렬(Parallel) 통신

 일반적으로 마이크로프로세서와 컴퓨터내의 주변장치와 정보를 교환할 때는 통상적으로 고속의 통신속도를 필요로 하기 때문에 한 번에 많은 양의 데이터를 처리 할 수 있는 병렬 통신 방식을 주로 쓴다. 대량의 정보를 빠른 시간에 한꺼번에 처리함으로써 컴퓨터의 성능을 향상 시킬 수 있기 때문이다.

* 대표적인 병렬 통신 방식을 사용하는 장치
  * HDD
  * FDD
  * CD-ROM
  * Memory
  * Veideo Card

- 다수의 비트(bit)를 한 번에 전송하는 방법이다.
- 타이밍(Clock)에 맞춰 모든 라인이 같이 동작할 수 있도록 Clock라인이 필요하다
  - 예를 들어 8-bit data bus의 경우 9라인이 사용된다.



### 직렬(Serial) 통신

 병렬 통신은 장비를 구현함에 있어서의 어려움과 거리의 제한성, 많은 비용이 든다는 단점이 있다. 또한 많은 양의 데이터 전송을 필요로 하지 않는 곳에 있어서 병렬 통신은 비효율적이다. 이러한 이유로 컴퓨터가 외부의 장치 간의 통신을 할 때 직렬 통신 방식을 많이 사용한다.

* 데이터 비트를 1개의 비트단위로 외부로 송수신 하는 방식
* 실시간으로 작은 데이터 처리를 요구하는 환경에서 사용한다.
* 대표적인 직렬 통신 장치
  * PC의 COM Port
  * USB
  * IEEE 1394
  * PCI Express
* 장점
  * 구현하기 쉽다.
  * 장거리에 유용하다.
  * 기존의 통신선로 등을 활용할 수 있어서 비용절감이 크다.
* 단점
  * 한 번에 한 비트씩 전송되므로 속도가 병렬 방식보다 상대적으로 느리다.
* 동기식통신과 비동기식 통신, 2종류의 통신 방식이 있다.



## 비동기식 통신과 동기식 통신

 직렬 통신에서 데이터는 하나의 신호선을 사용하여 한 번에 한 비트씩 전송되므로, 수신 측에서 데이터를 정확하게 수신하려면 송신측에서 각 비트를 전송할 속도를 알아야 한다.



### 동기식 통신

* 데이터가 클럭 신호와 동시에 송신된다.
* 데이터를 주고 받기 위해서 주고 받은 데이터 이외에 송수신 양측이 시간 간격(Timing)을 맞출 수 있는 동기신호(Clock)이 필요하다.
* 장점
  * 동일한 클럭을 사용하기 때문에 오류 없이 정확하게 송수신이 이루어진다.
  * 시작비트, 정지비트가 필요 없다.
  * 수신측에서 구분해야 될 데이터가 없다.
  * 많은 양의 데이터를 한 번에 보낼 수 있어서 비동기식 전송보다 빠르다.
  * 받는 쪽에서는 클럭의 하강엣지에서 데이터를 취하면 되기 때문에, 타이밍에 대해서 고민할 필요가 없다. 
* 단점
  * 비동기식에 비해 제어가 어렵다.
  * 가격이 비싸다.
  * 통신선이 한가닥 더 필요하다.


### 비동기식 통신

* 클럭없이 데이터의 시작과 끝을 나타내는 비트를 보낸다.

* 데이터 신호만을 보내고 각각의 방식에 따라 데이터 비트를 찾아낸다.

* 동기식 전송 방식에 비해 낮은 전송 속도를 갖는다.

* 현재 PC나 주변기기간의 통신에 많이 사용된다.

* 전기 장치들은 각각 자기의 클럭을 가지고있다. 클럭에 맞춰서 프로세스들이 하나하나 실행된다. 클럭이 서로 다른 기기들이 통신할 때(비동기 통신) 스피드가 다르기 때문에 성공적으로 통신하기 위해서는 송/수신측이 통신속도(baud rate: 초당 주고 받는 데이터 수)를 정해서 속도를 맞춰야 성공적으로 통신할 수 있다.


# UART(범용 비동기 통신)

- 병렬 데이터의 형태를 직렬 방식으로 전환하여 데이터를 전송하는 컴퓨터 하드웨어의 일종, 통신규격 중 하나다.  

- 통신 방법

  - 전송 선로: 유선(Wire)
  - 데이터를 보내는 신호: 디지털(Digital)
  - 전송 모드: 전이중(Full-Duplex)
    - 2개의 범용 입출력 핀이 필요하다.(시리얼 포트 -> RX, TX)
  - 데이터를 보내는 전송 방법: 직렬(Serial)
  - 송수신 간 신호를 맞추는 방법: 비동기(Asynchronous)
    - 비동기 통신이므로 동기 신호가 전달되지 않는다.

- uart에는 Rx와 Tx, Buffer, Gnd가 있다  

  - Rx: 데이터 수신
  - Tx: 데이터 송신
  - Buffer: Rx로 들어온 데이터를 저장하는 공간

- Rx(수신)과 Tx(송신)은 서로 교차해서 연결해야한다

- 비동기 통신이기 때문에 둘 간의 baud rate를 일치 시켜주어야 한다.

  - 보내는 쪽(Tx)과 받는 쪽(Rx)이 동일한 속도로 데이터를 주고 받는다고 해서 정확하게 통신이 이루어 지는 것은 아니다.
  - 보내는 쪽(Tx)은 항상 데이터를 보내는 것이 아니며, 필요한 경우에만 데이터를 보낸다. 따라서, 받는 쪽(Rx)은 언제 보내는 쪽(Tx)이 데이터를 보내는지, 그리고 어디서부터가 보내는 쪽(Tx)에서 보낸 데이터의 시작인지 알아낼 수 있는 방법이 필요한데, 이를 위해서, UART에서는 '0'의 시작비트와 '1'의 정지비트를 사용한다.

- 서로의 전위를 맞춰줘야 데이터가 제대로 해석 될 수 있기 때문에 GND(그라운드)를 맞춰줘야한다.

- 데이터 통신 구조(Framing the data)

  - 동기화 비트(Synchronization bits)

    2개 혹은 3개의 특수한 비트로 전송되는 데이터 패킷의 시작과 끝을 알린다.

    - 시작비트(Start bit): 통신의 시작을 의미하며 한 비트 시간 길이만큼 유지한다. 지금부터 정해진 약속에 따라 통신을 시작한다.
    - 종료비트(Stop bit): 통신 종료를 알린다. 세 가지의 정해진 비트만큼 유지해야한다. (1, 1.5, 2비트로 해당 레지스터 설정에 따라 결정된다.)

  - 데이터 영역(Data chunk): 실제 전송할 데이터를 말한다. 5~9bit를 사용할 수 있다.(보통 8bit 사용) 몇 비트를 사용할 것인지는 해당 레지스터 설정에 따라 결정된다. 7비트는 ASCII 문자를 전송하는데 필요한 비트이다.

  - 패리티 비트(Parity bit): 정보의 전달 과정에서 오류가 생겼는지 검사하기 위해 추가된 비트이다. 오류 검증을 하기 위한 패리티 값을 생성하여 송신하고 수신 쪽에서 오류 판단한다.

  - 하지만 오류 발생 여부만 알 수 있지 오류를 수정할 수 없다는 단점이 있다.

    데이터의 끝에 한 비트를 더하여 전송하는 방법으로 2가지 종류의 패리티 비트가 있다.

    전송하고자 하는 8-bit 데이터에 추가적으로 붙게되는 패리티 비트를 짝수 패리티로 설정할 것인가 홀수 패리티로 설정할 것인가에 따라서 붙게되는 패리티비트의 값이 달라진다.

    - 짝수 패리티

      실제 송신하고자 하는 데이터의 각 비트의 값 중에서 1의 개수가 짝수가 되도록 패리티 비트를 정하는 것이다.

    - 홀수 패리티

      전체 비트에서 1의 개수가 홀수가 되도록 패리티 비트를 정하는 방법이다.

    - Mark 패리티

      원격 측정법 원에서의 mark라 불리는 논리 1로 패리티 비트로 사용된다.

    - Space 패리티

      Space라 불리는 논리 0이 패리티 비트로 송신된다.

    - NONE

      어떤 종류의 패리티도 송신되지 않음을 의미한다.

    - 거리가 상당히 멀 경우에 주로 적용되며, 송수신 거리가 짧을 경우에는 보통의 경우 패리티 비트는 사용하지 않고, Checksum 데이터를 추가하는 방법으로 데이터의 오류 검출을 한다.


## Buffer  

- uart통신을 통해서 받은 데이터를 저장하는 공간이다.  

- FIFO구조이다.  

- **크기가 한정되어 있다.**  

  - 크기가 한정되어 있기 때문에 uart통신을 할 때 buffer overflow가 생기는 문제점도 있다.

  - 버퍼가 꽉 찼을 때 데이터가 들어오면 mcu마다 다르게 처리한다.  

    - 대표적인 3가지 case  

      1. Error 발생  
      2. 데이터를 받지 않는다.  
      3. 제일 처음 들어온 데이터를 밀어낸다.


# USART(범용 동기 비동기 통신)

USART는 UART에 비해 S라는 글자하나가 더 있는 것만 다르다. 여기서 S는 Synchronus의 약자이다. 즉 USART는 UART이면서 경우에 따라서는 클럭에 맞추어 데이터를 보내거나 받을 수 있도록 되어있다. 즉, 동기화된 통신을 지원한다. 클럭을 함께 보내면, 앞서 설명한 것처럼 데이터 받는 쪽에서의 일이 단순해지며, 이는 더 빠른 속도로 데이터를 주고 받는 것을 가능하게합니다. 

- 전이중 통신 가능. (송신,수신 동시에가능)
- 비동기 전송 모드 or 동기 전송모드 가능
- 마스터 모드 or 슬레이브 모드 가능
- 보레이트 발생기 내장(높은 정밀도)
- 패리티 체크 기능
- 마이크로컨트롤러에서 널리 사용되어온 통신 방식 중의 하나이다.
- 다른 통신에 비해 속도가 느리고, 멀리 데이터를 보낼 수는 없지만, 근거리에서 소량의 데이터를 보낼 때 매우 유용한 통신이다.



---

**용어**

-**Baud Rate (통신 속도)**: Baud rate 는 시리얼 라인으로 전송되는 데이터 속도를 말한다. Bits-per-second (bps) 단위로 표시하는데 이 값을 바탕으로 1 bit가 전송되는데 필요한 시간을 알 수 있다. 즉 1bit 데이터를 전송할 때 시리얼 라인을 high/low 상태로 유지하는 시간이며, 데이터를 받기 위해 시리얼 라인을 체크하는 시간이다.

-**단 방향 통신(Simplex)**: 언제나 수신만 할 뿐 송신은 할 수 없다. 반대로, 송신만 하고 수신은 할 수 없는 경우에도 단방향 통신이다.

-**반이중 통신** : 하나의 전송 회선을 사용하여 송수신을 전환하면서 통신하는 방식, 때문에 동시 통신이 불가능하다.

-**전이중 통신**: 송수신 모두 자체 전송 회선이 있어서 두 개의 디바이스 간에 양방향 송수신이 가능하고, 두 디바이스가 동시에 데이터 전송이 가능한 통신 방식

---

[참고자료](https://m.blog.naver.com/PostView.nhn?blogId=scw0531&logNo=220619256523&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F)

[참고자료](https://blog.naver.com/xisaturn/220750649418)

[참고자료](http://www.hardcopyworld.com/gnuboard5/bbs/board.php?bo_table=lecture_pract&wr_id=93)

[참고자료](http://blog.daum.net/_blog/BlogTypeView.do?blogid=0G65y&articleno=6766113)

[참고자료](http://shek.tistory.com/41)

[참고자료](http://ace3.yc.ac.kr/VBtext/%EC%8B%9C%EB%A6%AC%EC%96%BC%EA%B8%B0%EC%B4%881.htm)

---







